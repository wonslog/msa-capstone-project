# CQRS

주문 발생 시, 주문 상태값, 주문 금액에 대해 고객이 조회할 수 있도록 CQRS로 구현하였습니다.
- 비동기식으로 처리되어 이벤트 기반의 Kafka를 통해 처리되어 별도 Table에 관리한다.
- order, payment, delivery Aggregate의 '마이페이지' 형식과 같이 통합 조회가 가능하다.
- Modeling

![orderDetail_modeling](https://user-images.githubusercontent.com/11211944/168709433-11239a86-4a5b-4540-a3f1-e5a7a7bbb3f1.PNG)

- ViewHandler를 통해 구현(ordered 이벤트 발생 시)
 ![create](https://user-images.githubusercontent.com/11211944/168711238-ecb228dc-6ccd-4af9-ac58-93a9c3ffb99d.PNG)

- OrderCanceled 이벤트 발생 시, orderStatus 상태 값 변경
![update1](https://user-images.githubusercontent.com/11211944/168711242-b665664d-afec-474d-808b-2d6dc9cd5513.PNG)

- PaymentApproved 이벤트 발생 시, paymentStatus 상태 값 변경
![update2](https://user-images.githubusercontent.com/11211944/168711247-04cd6218-0a4f-48b3-8503-334d82e5b4e6.PNG)

- PaymentCanceled 이벤트 발생 시, paymentStatus 상태 값 변경
![update3](https://user-images.githubusercontent.com/11211944/168711252-0028b8d4-7a4f-4d31-bec9-4dd93ea2761c.PNG)

- DeliveryStarted 이벤트 발생 시, orderStatus 상태 값 변경
![update4](https://user-images.githubusercontent.com/11211944/168711258-96ed0aab-291b-4671-bb5a-627f8aec144c.PNG)

- DeliveryCanceled 이벤트 발생 시, orderStatus 상태 값 변경
![update5](https://user-images.githubusercontent.com/11211944/168711224-288a0300-9344-4215-ae2f-70119cf47d0d.PNG)
